define(["qlik"],function(e){"use strict";function t(e){var t=n("link");t.rel="stylesheet",t.type="text/css",t.href=require.toUrl(e),document.head.appendChild(t)}function n(e,t,n){var r=document.createElement(e);return t&&(r.className=t),n!==undefined&&(r.innerHTML=n),r}function r(e,t){e.childNodes.length===0?e.appendChild(t):e.replaceChild(t,e.childNodes[0])}function i(t){var n=e.currApp();n.variable.getByName?n.variable.getByName(t).then(function(){},function(){n.variable.create(t)}):n.variable.create(t)}function s(e){return(e.value-e.min)*100/(e.max-e.min)}function o(e,t,n){switch(e){case"material":case"bootstrap":if(n)return"selected";break;default:switch(t){case"button":return n?"qui-button-selected":"qui-button";case"select":return"qui-select";case"input":return"qui-input"}}}function u(e){if(e.render==="l")return"98%";if(e.width==="custom")return e.customwidth;if(e.width==="fill")return e.render!=="b"?"100%":"calc( "+100/e.alternatives.length+"% - 3px)"}return t("extensions/variable/variable.css"),{initialProperties:{variableValue:{},variableName:"",render:"f",alternatives:[],min:0,max:100,step:1,style:"qlik",width:"",customwidth:""},definition:{type:"items",component:"accordion",items:{settings:{uses:"settings",items:{variable:{type:"items",label:"Variable",items:{name:{ref:"variableName",label:"Name",type:"string",change:function(e){i(e.variableName),e.variableValue=e.variableValue||{},e.variableValue.qStringExpression="="+e.variableName}},style:{type:"string",component:"dropdown",label:"Style",ref:"style",options:[{value:"qlik",label:"Qlik"},{value:"bootstrap",label:"Bootstrap"},{value:"material",label:"Material"}]},width:{type:"string",component:"dropdown",label:"Width",ref:"width",options:[{value:"",label:"Default"},{value:"fill",label:"Fill"},{value:"custom",label:"Custom"}]},customwidth:{type:"string",ref:"customwidth",label:"Custom width",expression:"optional",show:function(e){return e.width==="custom"}},render:{type:"string",component:"dropdown",label:"Render as",ref:"render",options:[{value:"b",label:"Button"},{value:"s",label:"Select"},{value:"f",label:"Field"},{value:"l",label:"Slider"}],defaultValue:"f"},alternatives:{type:"array",ref:"alternatives",label:"Alternatives",itemTitleRef:"label",allowAdd:!0,allowRemove:!0,addTranslation:"Add Alternative",items:{value:{type:"string",ref:"value",label:"Value",expression:"optional"},label:{type:"string",ref:"label",label:"Label",expression:"optional"}},show:function(e){return e.render==="b"||e.render==="s"}},min:{ref:"min",label:"Min",type:"number",defaultValue:0,show:function(e){return e.render==="l"}},max:{ref:"max",label:"Max",type:"number",defaultValue:100,show:function(e){return e.render==="l"}},step:{ref:"step",label:"Step",type:"number",defaultValue:1,show:function(e){return e.render==="l"}},rangelabel:{ref:"rangelabel",label:"Slider label",type:"boolean",defaultValue:!1,show:function(e){return e.render==="l"}}}}}}}},paint:function(t,i){var a=n("div",i.style||"qlik"),f=u(i),l=this;if(i.render==="b")i.alternatives.forEach(function(t){var r=n("button",o(i.style,"button",t.value===i.variableValue),t.label);r.onclick=function(){e.currApp(l).variable.setContent(i.variableName,t.value)},r.style.width=f,a.appendChild(r)});else if(i.render==="s"){var c=n("select",o(i.style,"select"));c.style.width=f,i.alternatives.forEach(function(e){var t=n("option",undefined,e.label);t.value=e.value,t.selected=e.value===i.variableValue,c.appendChild(t)}),c.onchange=function(){e.currApp(l).variable.setContent(i.variableName,this.value)},a.appendChild(c)}else if(i.render==="l"){var h=n("input");h.style.width=f,h.type="range",h.min=i.min||0,h.max=i.max||100,h.step=i.step||1,h.value=i.variableValue,h.onchange=function(){this.label?(this.label.style.left=s(this)+"%",this.label.textContent=this.value):this.title=this.value,e.currApp(l).variable.setContent(i.variableName,this.value)},h.oninput=function(){this.label?(this.label.style.left=s(this)+"%",this.label.textContent=this.value):this.title=this.value},a.appendChild(h);if(i.rangelabel){var p=n("div","labelwrap");h.label=n("div","rangelabel",i.variableValue),h.label.style.left=s(h)+"%",p.appendChild(h.label),a.appendChild(p)}else h.title=i.variableValue}else{var d=n("input",o(i.style,"input"));d.style.width=f,d.type="text",d.value=i.variableValue,d.onchange=function(){e.currApp(l).variable.setContent(i.variableName,this.value)},a.appendChild(d)}r(t[0],a)}}});